"use strict";function getRandomNum(a,t){return parseInt(Math.random()*(t-a+1)+a)}function getRandomColor(){return"rgb("+getRandomNum(0,255)+","+getRandomNum(0,255)+","+getRandomNum(0,255)+")"}jQuery(function(){$(".car_footer").load("index.html #footer #fuwu"),$(".car_header").load("index.html #header #topNav",function(){function o(a,t,e,n){$.ajax({url:"api/car_count.php",data:{id:a,count:t,user:e,type:n},success:function(a){"1"==a&&i(e)}})}function i(i){""!=i&&$.ajax({url:"api/ready_car.php",data:{user:i},success:function(a){var t,e,n;car_obj=JSON.parse(a),t=car_obj,$(".car_lists").html($.map(t,function(a,t){return'<div class="list" data-id="'+a.com_id+'">\n                                <ul class="clearfix">\n                                    <li class="ck">\n                                        <input type="checkbox" class="li_ck">\n                                    </li>\n                                    <li class="img_name">\n                                        <img src="'+a.com_img+'" alt="" class="fl">\n                                        <p class="fl">'+a.com_name+'</p>\n                                    </li>\n                                    <li class="dangjia">\n                                        ￥<span class="z_price">'+a.com_price+'</span>\n                                    </li>\n                                    <li class="youhui">-</li>\n                                    <li class="yun">\n                                        <input type="button" class="jianBtn" value="-" /><input type="text" value="'+a.count+'"  class="shuLiang" /><input type="button" class="jiaBtn" value="+" />\n                                    </li>\n                                    <li class="zongjia">\n                                        ￥<span class="totalvl">'+a.com_price*a.count+'</span>\n                                    </li>\n                                    <li class="caozuo">\n                                        <a class="collectBtn">收藏</a>\n                                        <a class="deleteBtn">删除</a>\n                                    </li>\n                                </ul>\n                            </div>'})),$(".total_money").html((e=0,$(".totalvl").each(function(){e+=Number($(this).text())}),e)),n=i,$(".jianBtn").on("click",function(){var a=$(this).parents(".list").attr("data-id");1!=$(this).next().val()&&o(a,"-",n,0)}),$(".jiaBtn").on("click",function(){o($(this).parents(".list").attr("data-id"),"+",n,0)}),$(".deleteBtn").on("click",function(){o($(this).parents(".list").attr("data-id"),"",n,1)}),$(".clear_car").on("click",function(){o("*","",n,1)}),$(".dele_ck").on("click",function(){var a=$(".li_ck").filter(":checked").parents(".list");$.each(a,function(a,t){o(t.dataset.id,"",n,1)})}),$(".check_ll").on("click",function(){$(".check_ll").prop("checked",$(this).prop("checked")),$(".li_ck").prop("checked",$(this).prop("checked"))}),$(".li_ck").on("click",function(){var a=$(".li_ck").filter(":checked").length,t=$(".li_ck").length;$(".check_ll").prop("checked",t==a)})}})}$.getScript("js/common.js",function(){dl();var a,n,t=$("#login_name").text();i(t),a=1,n=t,$.ajax({url:"api/list.php",data:{page:a,qty:12},success:function(a){var t,e;obj=JSON.parse(a),t=obj.data,$(".xy_libox").html($.map(t,function(a,t){return'<li data-id="'+a.com_id+'">\n                                <a class="go_goods">\n                                    <img src="'+a.com_img+'" alt="">\n                                    <p>'+a.com_name+'</p>\n                                </a>\n                                <p>￥<span class="xy_money">'+a.com_price+'</span></p>\n                                <span class="xy_addCar"></span>\n                            </li>'})),$(".go_goods").on("click",function(){var a=$(this).parents("li").attr("data-id");location.href="html/goods.html?comId="+a}),e=n,$(".xy_addCar").on("click",function(){var a=$(this).parents("li").attr("data-id");$.ajax({url:"api/add_car.php",data:{id:a,user:e},success:function(a){i(e)}})})}})})})});var Element={getElement:function(a){var t=[];return a.forEach(function(a){1==a.nodeType&&t.push(a)}),t},getSonElement:function(a){return this.getElement(a.childNodes)},getNextElement:function(a){var t=a.nextSibling;return 1!=t.nodeType&&(t=t.nextSibling),t}};function getStyle(a,t){return window.getComputedStyle?window.getComputedStyle(a)[t]:a.currentStyle?a.currentStyle[t]:a.style[t]}function bind(a,t,e,n){a.addEventListener?a.addEventListener(t,e,n):a.attachEvent?a.attachEvent("on"+t,e):a["on"+t]=e}function bufferAnimation(o,a,t,c){var s=0;for(var e in a){s++,n(e,a[e])}function n(n,i){console.log(i),i="opacity"==n?100*i:i,clearInterval(o[n+"timer"]),o[n+"timer"]=setInterval(function(){var a=window.getComputedStyle(o)[n],t=a.match(/[a-z]+/);t=t?t[0]:"",a=parseFloat(a);var e=(i-(a="opacity"==n?100*a:a))/10;(a+=e=0<e?Math.ceil(e):Math.floor(e))==i&&(clearInterval(o[n+"timer"]),s--),a="opacity"==n?a/100:a,o.style[n]=a+t,0==s&&"function"==typeof c&&c()},t)}}var Cookie={setCookie:function(a,t,e,n){var i=a+"="+t;e&&(i+="; expires="+e.toUTCString()),n&&(i+="; path="+n),document.cookie=i},getCookie:function(e){var a=document.cookie.split("; "),n="";return a.forEach(function(a){var t=a.split("=");t[0]==e&&(n=t[1])}),n},removeCookie:function(a,t){var e=new Date;e.setDate(e.getDate()-1),this.setCookie(a,"",e,t)}};function draw(a){var t=$(".ver_code").width(),e=$(".ver_code").height(),n=document.querySelector(".ver_code"),i=n.getContext("2d");n.width=t,n.height=e;for(var o="a,b,c,d,e,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,J,K,L,M,N,P,Q,R,S,T,W,X,Y,Z,1,2,3,4,5,6,7,8,9,0".split(","),c=o.length,s=0;s<4;s++){var l=Math.floor(Math.random()*c),r=Math.random()-.5,d=o[l];a[s]=d.toLowerCase();var p=10+18*s,u=20+10*Math.random();i.font="bold 23px 微软雅黑",i.translate(p,u),i.rotate(r),i.fillStyle=getRandomColor(),i.fillText(d,0,0),i.rotate(-r),i.translate(-p,-u)}for(s=0;s<=5;s++)i.strokeStyle=getRandomColor(),i.beginPath(),i.moveTo(Math.random()*t,Math.random()*e),i.lineTo(Math.random()*t,Math.random()*e),i.stroke();for(s=0;s<=30;s++){i.strokeStyle=getRandomColor(),i.beginPath();p=Math.random()*t,u=Math.random()*e;i.moveTo(p,u),i.lineTo(p+1,u+1),i.stroke()}}function dl(){var a=Cookie.getCookie("uname");""!=a&&($("#login").hide(),$("#quit").show(),$("#login_name").text(a)),$(".tuichu").on("click",function(){$("#quit").hide(),$("#login").show(),Cookie.removeCookie("uname","/"),window.location.reload()}),setInterval(function(){$(".friendLinkList").animate({top:"-32px"},1500,function(){$(".friendLinkList").animate({top:"0px"},1500)})},4e3),$(".app_p").hover(function(){$(".appImg").show()},function(){$(".appImg").hide()}),$(window).scroll(function(){800<$(window).scrollTop()?$("#fixNav").show():$("#fixNav").hide()}),""!=a&&$.ajax({url:"api/ready_car.php",data:{user:a},success:function(a){var t=JSON.parse(a),e=0;$.each(t,function(a,t){e+=Number(t.count)}),$(".count").text(e)}}),""!=$(".fixBox")&&($(".fanghui").on("click",function(){window.scrollTo(0,0)}),$(".fixBox ul li a").hover(function(){$(this).children(".tangchu").css({display:"block"}),$(this).children(".tangchu").stop(!0).animate({opacity:1,right:"32px"},500)},function(){$(this).children(".tangchu").stop(!0).animate({opacity:0,right:"80px"},500,function(){$(this).css({display:"none"})})}))}jQuery(function(){$("#fixBox").load("index.html .fixBox"),$(".g_footer").load("index.html #footer"),$(".g_header").load("index.html #header",function(){$.getScript("js/common.js",function(){var t,e;dl(),$(".jia").on("click",function(){var a=$(".c_count").val();$(".c_count").val(Number(a)+1)}),$(".jian").on("click",function(){var a=$(".c_count").val();1!=a&&$(".c_count").val(Number(a)-1)}),t=a,e=$("#login_name").text(),$(".m_addCar").on("click",function(){var a=$(".c_count").val();$.ajax({url:"api/add_car.php",data:{id:t,user:e,count:a},success:function(a){console.log(a),1==a&&$.ajax({url:"api/ready_car.php",data:{user:e,type:0},success:function(a){var t=JSON.parse(a),e=0;$.each(t,function(a,t){e+=Number(t.count)}),$(".count").text(e)}})}})}),$.ajax({url:"api/list.php",data:{page:5,qty:4},success:function(a){var t;obj=JSON.parse(a),t=obj.data,$(".tj_ul").html($.map(t,function(a){return'<li data-id="'+a.com_id+'">\n                            <a class="go_goods clearfix">\n                                <img src="'+a.com_img+'" alt="">\n                                <div class="fl">\n                                    <p>'+a.com_name+'</p>\n                                    <span>￥<span class="t_money">'+a.com_price+"</span></span>\n                                </div>\n                            </a>\n                        </li>"})),$(".lsc2").children("img").prop("src",t[0].com_img),$(".lsc3").children("img").prop("src",t[1].com_img),$(".lsc4").children("img").prop("src",t[2].com_img),$(".last").children("img").prop("src",t[3].com_img),$(".go_goods").on("click",function(){var a=$(this).parents("li").attr("data-id");location.href="html/goods.html?comId="+a})}})});var a=location.search.slice(1).split("=")[1];$.ajax({url:"api/commodity.php",data:{id:a},success:function(a){var t;t=JSON.parse(a),$(".datu").children("img").prop("src",t[0].com_img),$(".select").children("img").prop("src",t[0].com_img),$(".msg_top").children("h3").text(t[0].com_name),$(".ps_money").text(t[0].com_price),$(".pj").children("span").text(t[0].com_eval)}}),$(".listpic").on("mouseover",function(){$(".datu").children("img").prop("src",$(this).children("img")[0].src)}),$(".datu").mouseover(function(){$(".datuBtn").show(),$(".glassImg img").prop("src",$(this).children("img")[0].src),$(".glassImg").show()}),$(".datu").mouseout(function(){$(".datuBtn").hide(),$(".glassImg").hide()}),$(".datu").mousemove(function(a){var t=a.pageY-$(this).offset().top-$(".datuBtn").height()/2,e=a.pageX-$(this).offset().left-$(".datuBtn").width()/2,n=$(this).width()-$(".datuBtn").width(),i=$(this).height()-$(".datuBtn").height();e<0?e=0:n<e&&(e=n),t<0?t=0:i<t&&(t=i),$(".datuBtn").css("left",e),$(".datuBtn").css("top",t);var o=e/n,c=t/i;$(".glassImg img").css({left:-o*($(".glassImg img").width()-$(".glassImg").width()),top:-c*($(".glassImg img").height()-$(".glassImg").height())})})})}),jQuery(function(n){n("#output").lunbo({imgurl:["img/index/7d2f0da441884ab98365e768dfa61d5e.jpg","img/index/ba40a2e1b72d40b99065cfe4419fe2bd.jpg","img/index/65e3c6fd815645f497e2b35e12800a09.jpg","img/index/8518fd4a74f443a896df10921bfcf905.jpg","img/index/8702d80f5662476d92794ff04b7283ba.jpg","img/index/b5a3ba84a4354702bce87068d5b59ec6.jpg","img/index/4b089ae5e1c7472296fbbaae77bc0fad.jpg"],type:"faded"});new Swiper(".swiper-container",{direction:"horizontal",navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});function a(e,a){n.ajax({url:"api/activity.php",data:a,success:function(a){var t;obj=JSON.parse(a),t=obj,n(e).html(n.map(t,function(a,t){return'<a href="">\n                            <img src="'+a.com_img+'" alt="">\n                        </a>'}))}})}function t(e,a){n.ajax({url:"api/commodity.php",data:a,success:function(a){var t;obj=JSON.parse(a),t=obj,n(e).html(n.map(t,function(a,t){return'<li data-id="'+a.com_id+'">\n                            <a class="go_goods">\n                                <div>'+a.com_recom+'</div>\n                                <img src="'+a.com_img+'" alt="">\n                                <p>'+a.com_name+"</p>\n                                <span>"+a.com_price+"元</span>\n                            </a>\n                        </li>"})),i()}})}function e(a,t,e){n.ajax({url:"api/list.php",data:{page:a,qty:e},success:function(a){obj=JSON.parse(a),t(obj.data)}})}function i(){n(".go_goods").on("click",function(){var a=n(this).parents("li").attr("data-id");location.href="html/goods.html?comId="+a})}n(".erji").show(),dl(),t(".maotai",{type:0}),t(".laojiu",{type:1}),t(".zhekou",{type:2}),t(".chaozhi",{type:3}),t(".remai",{type:4}),a(".mthuodong",{type:0}),a(".ljhuodong",{type:1}),a(".zkhuodong",{type:2}),a(".czhuodong",{type:3}),a(".rmhuodong",{type:4}),e(5,function(a){n(".cont_ul").html(n.map(a,function(a,t){return'<li data-id="'+a.com_id+'">\n                            <a class="go_goods">\n                                <img src="'+a.com_img+'" alt="">\n                                <p> <span id="a_name">'+a.com_name+'</span> <span id="a_price">'+a.com_price+"元</span></p>\n                            </a>\n                        </li>"})),i()},7),e(1,function(a){n(".slide1").html(n.map(a,function(a,t){return'<li data-id="'+a.com_id+'">\n                            <a class="go_goods">\n                                <img src="'+a.com_img+'" alt="">\n                                <p class="s_name">'+a.com_name+'</p>\n                                <p class="s_price">'+a.com_price+'元</p>\n                                <p class="s_pinglun">'+a.com_eval+" 人好评</p>\n                            </a>\n                        </li>"})),i()},5),e(2,function(a){n(".slide2").html(n.map(a,function(a,t){return'<li data-id="'+a.com_id+'">\n                            <a class="go_goods">\n                                <img src="'+a.com_img+'" alt="">\n                                <p class="s_name">'+a.com_name+'</p>\n                                <p class="s_price">'+a.com_price+'元</p>\n                                <p class="s_pinglun">'+a.com_eval+" 人好评</p>\n                            </a>\n                        </li>"})),i()},5)}),jQuery(function(o){o("#fixBox").load("index.html .fixBox"),o(".w_footer").load("index.html #footer"),o(".w_header").load("index.html #header",function(){function t(){o("#com_id").on("click",function(){o(this).addClass("active").siblings().removeClass("active"),n(1,"com_id",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())}),o("#com_name").on("click",function(){o(this).addClass("active").siblings().removeClass("active"),n(1,"com_name",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())}),o("#com_price").on("click",function(){o(this).addClass("active").siblings().removeClass("active"),n(1,"com_price",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())}),o("#com_eval").on("click",function(){o(this).addClass("active").siblings().removeClass("active"),n(1,"com_eval",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())}),o("#time").on("click",function(){o(this).addClass("active").siblings().removeClass("active"),n(1,"time",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())})}function n(i,a,t,e,n){o.ajax({url:"api/list.php",data:{page:i,qty:8,type:a,start_val:t,over_val:e,jiu_val:n},success:function(a){var t,e;obj=JSON.parse(a),t=obj.data,o(".pr_list").html(o.map(t,function(a,t){return'<li data-id="'+a.com_id+'">\n                                <a class="go_goods">\n                                    <img src="'+a.com_img+'" alt="">\n                                    <p class="pr_name"><span>'+a.com_name+"</span><em>"+a.com_recom+'</em></p>\n                                    <p class="pr_huodong"></p>\n                                </a>\n                                <div class="add_car clearfix">\n                                    <p class="fl"><i>￥</i><span>'+a.com_price+'</span></p>\n                                    <button class="fr add">加入购物车</button>\n                                </div>\n                                <p class="pr_pingjia">评价：'+a.com_eval+"条</p>\n                            </li>"})),e=o("#login_name").text(),o(".add").on("click",function(){var a=o(this).parents("li").attr("data-id");o.ajax({url:"api/add_car.php",data:{id:a,user:e},success:function(a){"1"==a&&o.ajax({url:"api/ready_car.php",data:{user:e,type:0},success:function(a){var t=JSON.parse(a),e=0;o.each(t,function(a,t){e+=Number(t.count)}),o(".count").text(e)}})}})}),o(".go_goods").on("click",function(){var a=o(this).parents("li").attr("data-id");location.href="html/goods.html?comId="+a}),o(".page").html("");var n=Math.ceil(obj.count/obj.qty);for($i=1;$i<=n;$i++)o("<span/>").appendTo(o(".page")).text($i).addClass($i==obj.page?"active":"");o(o(".page span")[i-1]).addClass("active").siblings().removeClass("active")}})}o.getScript("js/common.js",function(){dl()}),n(1),t(),o(".jiu_name").on("click",function(){o(".search-jiu")&&o(".search-jiu").remove(),o(".search-hassel").append('<a class="search-jiu fl" id="search_1" data-hr="qingjiu"><em class="jiuName">'+o(this).text()+'</em>&nbsp;<span class="close_tj">✖</span></a> '),n(1,"com_price",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text()),o(".close_tj").on("click",function(){o(this).parents("a").remove(),t()})}),o(".cd-table").on("click","a",function(){o(".search-selected")&&o(".search-selected").remove();var a=o(this).attr("class");"nfw1"==a&&(o(".search-hassel").append('<a class="search-selected fl" id="search_1" data-hr="qingjiu"><em><span class="sta_val">1</span>-<span class="over_val">199</span>元</em>&nbsp;<span class="close_tj">✖</span></a> '),n(1,"com_price",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())),"nfw2"==a&&(o(".search-hassel").append('<a class="search-selected fl" id="search_1" data-hr="qingjiu"><em><span class="sta_val">200</span>-<span class="over_val">399</span>元</em>&nbsp;<span class="close_tj">✖</span></a> '),n(1,"com_price",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())),"nfw3"==a&&(o(".search-hassel").append('<a class="search-selected fl" id="search_1" data-hr="qingjiu"><em><span class="sta_val">400</span>-<span class="over_val">599</span>元</em>&nbsp;<span class="close_tj">✖</span></a> '),n(1,"com_price",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())),"nfw4"==a&&(o(".search-hassel").append('<a class="search-selected fl" id="search_1" data-hr="qingjiu"><em><span class="sta_val">600</span><span class="over_val">元及以上</span></em>&nbsp;<span class="close_tj">✖</span></a> '),n(1,"com_price",o(".search-selected .sta_val").text(),o(".search-selected .over_val").text(),o(".jiuName").text())),o(".close_tj").on("click",function(){o(this).parents("a").remove(),t()}),t()}),o(".page").on("click","span",function(){var a=o(this).text();if(o(".sort-box .active").attr("id"))var t=o(".sort-box .active").attr("id");n(a,t),o(document).scrollTop(0)}),o(".xiangzuo").on("click",function(){var a=o(".active").text();if(0==--a&&(a=1),o(".sort-box .active").attr("id"))var t=o(".sort-box .active").attr("id");n(a,t),o(o(".page span")[a-1]).addClass("active").siblings().removeClass("active"),o(document).scrollTop(0)}),o(".xiangyou").on("click",function(){var a=o(".active").text(),t=o(".page").children().length;if(t<++a&&(a=t),o(".sort-box .active").attr("id"))var e=o(".sort-box .active").attr("id");n(a,e),o(o(".page span")[a+1]).addClass("active").siblings().removeClass("active"),o(document).scrollTop(0)})})}),jQuery(function(o){var s=[];draw(s);var l=o("#autologin"),a=Cookie.getCookie("uname"),t=Cookie.getCookie("upsd");console.log(a,t),a&&o.ajax({type:"POST",url:"../api/login.php",data:{uname:a,upsd:t},success:function(a){a&&(c,location.href="../index.html?")}}),o("#btnSubmit").on("click",function(){var t,e=o("#txtUserName").val(),a=o("#txtPassword").val(),n=o("#loginCode"),i=s.join("");o.ajax({type:"POST",url:"../api/login.php",data:{uname:e,upsd:a},success:function(a){t=a,"none"==n[0].style.display?t?(l[0].checked&&(Cookie.removeCookie("uname","/"),Cookie.removeCookie("upsd","/")),Cookie.setCookie("uname",e,"","/"),location.href="../index.html?"):(alert("用户名或密码错误！"),o("#loginCode").show()):(console.log(!t),t?o("#txtCode").val()!=i?(alert("验证码不正确！"),draw(s)):(l[0].checked&&(Cookie.removeCookie("uname","/"),Cookie.removeCookie("upsd","/")),Cookie.setCookie("uname",e,"","/"),location.href="../index.html?"):alert("用户名或密码错误！"))}})})}),jQuery(function(e){var n,i=e(".register_inner").find("input"),o=[];draw(o),i.first().on("blur",function(){console.log(e(this).val()),e.ajax({url:"../api/reg.php",data:{uname:e(this).val()},success:function(a){(n=a)&&alert("用户名已存在")}})}),e("#replace_img").on("click",function(){draw(o)}),e(".btnSubmit").on("click",function(){var a=o.join(""),t="";return i.each(function(){if(""==e(this).val())return!(t="文本框不能为空")}),t?alert(t):/^1([38][0-9]|4[579]|5[0-3,5-9]|6[6]|7[0135678]|9[89])\d{8}$/.test(i.first().val())?i.eq(1).val()!=a?alert("验证码不正确！"):/^\w{6,22}$/.test(i.eq(2).val())?i.eq(3).val()!=i.eq(2).val()?alert("两次密码不一致！"):n?alert("用户名已存在！"):e.ajax({type:"post",url:"../api/reg_add.php",data:{uname:i.first().val(),upsd:i.eq(2).val()},success:function(a){a&&(Cookie.setCookie("uname",i.first().val(),"","/"),location.href="../index.html")}}):alert("设置密码格式不正确！"):alert("手机号格式不正确！"),!1})});